# 字符串格式化
python 中提供format函数来格式化字符串。

字符串方法，`str.format(*args, **kwargs)`  
`str.format()` 是最常见的string中内置的方法  
基本语法是通过带有 `{}` 和 `:` 来代替以前的 `%`,的**格式字符串**构成。

python内置函数，`format(value[, format_spec])`  
将 `value` 转换为“格式化后”的形式，格式由 `format_spec` 进行控制。`format_spec` 使用一种标准的格式化语法： **格式规格迷你语言**。  
`format_spec` 如果为空，默认给出与调用 `str(value)` 相同的结果

## 格式规格迷你语言
可以被直接传给内置的 `format()` 函数。

`format_spec` 的一般格式：  
`[[fill]align][sign][#][width][grouping_option][.precision][type]`
- `[[fill]align]`:    
align 控制选项如下：  

|选项|说明|
|:--:|:--|
|`<`|强制字段可用空间内左对齐(大多数对象默认值)|
|`>`|强制字段可用空间内右对齐(数字的默认值)|
|`=`|强制在符号（如果有）之后数码之前放置填充。|
|`^`|强制居中|

fill 用于将任意字符填充剩余空间。默认为空格字符。以下为示例：
```python
>>> format('1','<10')
'1         '
>>> format(' QwQ ','*^15')
'***** QwQ *****'
>>> format(-1,'=10')
'-        1'
```
- `[sign]` 选项仅对数字类型有效：

|选项|说明|
|:--:|:--|
|`+`|表示标志应该用于正数和负数。|
|`-`|表示标志应仅用于负数（这是默认行为）。|
|`space`|表示应在正数上使用前导空格，在负数上使用减号。|
```python
>>> format(2,'*> 8')
'****** 2'
>>> format(2,'>+8')
'      +2'
```
- `[#]`选项可让“替代形式”被用于执行转换。
    - 对于`整数类型`，当使用二进制、八进制或十六进制输出时，此选项会为输出值分别添加相应的 `'0b'`, `'0o'`, `'0x'` 或 `'0X'` 前缀。 
    - 对于`浮点数`和`复数类型`，强制输出小数点，并且对于没有小数部分的浮点数，会自动添加 '.0' 作为小数部分。 
    - 对于 `'g'` 和 `'G'` 转换，末尾的零不会从结果中被移除。

示例：
```python
>>> format(28,'#x')
'0x1c'
>>> format(28,'x')
'1c'
```
- `[width]` 选项是一个定义最小总字段宽度的十进制整数，包括任何前缀、分隔符和其他格式化字符。 如果未指定，则字段宽度将由内容确定。  

当未显式给出对齐方式时，在 width 字段前加一个零 ('0') 字段将为数字类型启用感知正负号的零填充。
```python
>>> format(114514,'010')
'0000114514'
```
- `[grouping_option]` 拥有两个选项`"_" | ","`
    - `','` 选项表示使用逗号作为千位分隔符。
    - `'_'` 选项表示对浮点表示类型和整数表示类型 `'d'` 使用下划线作为千位分隔符。 对于整数表示类型 `'b'`, `'o'`, `'x'` 和 `'X'`，将为每 4 个数位插入一个下划线。 对于其他表示类型指定此选项则将导致错误。

```python
>>> format(114514,'<+10,')
'+114,514  '
>>> format(114514,'<+10_d')
'+114_514  '
```
- `[.precision]` 选项是一个十进制整数。
    - 对于`'f'` 和 `'F'` 格式化的数值应当在小数点后显示多少个数位。
    - 对于以表示类型 `'g'` 或 `'G'` 格式化的数值应当在小数点前后显示多少个数位。 
    - 对于`字符串`表示类型，该字段表示最大的字段大小 ——换句话说，就是要使用多少个来自字段内容的字符。 
    - 对于`整数`表示类型是不允许使用的。

```python
>>> format(114514,'.2f')
'114514.00'
>>> format(114514,'.2g')
'1.1e+05'
>>> format('114514','.4')
'1145'
```
- `[type]`确定了数据应如何呈现  

字符串表示类型是：

|选项|说明|
|:--:|:--|
|'s'|字符串格式。这是字符串的默认类型，可以省略。|
|None|和 's' 一样。|

整数表示类型是：

|选项|说明|
|:--:|:--|
|'b'|二进制格式。 输出以 2 为基数的数字。|
|'c'|字符。在打印之前将整数转换为相应的unicode字符。|
|'d'|十进制整数。 输出以 10 为基数的数字。|
|'o'|八进制格式。 输出以 8 为基数的数字。|
|'x'|十六进制格式。 输出以 16 为基数的数字，使用小写字母表示 9 以上的数码。|
|'X'|十六进制格式。 输出以 16 为基数的数字，使用大写字母表示 9 以上的数码。 在指定 `'#'` 的情况下，前缀 '0x' 也将被转为大写形式 '0X'。|
|'n'|数字。 这与 '`d`' 相似，不同之处在于它会使用当前区域设置来插入适当的数字分隔字符。|
|None|和 '`d`' 相同。|

float 和 Decimal 值的可用表示类型有：

|选项|说明|
|:--:|:--|
|'e'|科学计数法。 |
|'E'|科学计数法。 与 '`e`' 相似，不同之处在于它使用大写字母 '`E`' 作为分隔字符。|
|'f'|定点表示法。 |
|'F'|定点表示。 与 'f' 相似，但会将 nan 转为 NAN 并将 inf 转为 INF。|
|'g'|常规格式。 对于给定精度 p >= 1，这会将数值舍入到 p 个有效数位，再将结果以定点表示法或科学计数法进行格式化，具体取决于其值的大小。 精度 0 会被视为等价于精度 1。|
|'G'|常规格式。 类似于 'g'，不同之处在于当数值非常大时会切换为 'E'。 无穷与 NaN 也会表示为大写形式。|
|'n'|数字。 这与 'g' 相似，不同之处在于它会使用当前区域设置来插入适当的数字分隔字符。|
|'%'|百分比。 将数字乘以 100 并显示为定点 ('f') 格式，后面带一个百分号。|
|None|对于 `float` 来说这类似于 '`g`'，不同之处在于当使用定点表示法时，小数点之后将至少显示一位。 所用的精度会大到足以精确表示给定的值。对于 `Decimal` 来说这相当于 '`g`' 或 '`G`'|



常见示例：
```python
>>> '{}, {}, {}'.format('a', 'b', 'c')
'a, b, c'
>>> '{2}, {1}, {0}'.format('a', 'b', 'c')   # 指定位置调用
'c, b, a'
>>> "a:{a}, b:{b}".format(a="****", b="text22223")  # 带参数传递
'a:****b:text22223'
>>> site = {"a": "***", "b": "233333"}
>>> "a:{a}, b:{b}".format(**site)           # 通过字典设置参数
'a:***b:233333'
>>> my_list = ['****', '2333333333']        # 通过列表索引设置参数
>>> "a:{0[0]}, b:{0[1]}".format(my_list)    # 无拆包
'a:****, b:2333333333'
>>> "a:{0}, b:{1}".format(*my_list)         # 拆包
'a:****, b:2333333333'
```

## 格式字符串语法